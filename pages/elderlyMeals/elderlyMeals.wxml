<view class="container">
    <!-- 页面头部 -->
    <view class="header">
        <van-nav-bar title="养老用餐" left-text="返回" left-arrow bind:click-left="goBack" />
    </view>

    <!-- 温馨提示 -->
    <view class="notice-banner">
        <view class="notice-content">
            <van-icon name="info-o" size="28rpx" color="#FF6B35"/>
            <text class="notice-text">此页面仅为示例展示，即将投入使用</text>
        </view>
    </view>

    <!-- 社区选择器 -->
    <view class="community-selector">
        <van-dropdown-menu>
            <van-dropdown-item value="{{selectedCommunity}}" options="{{communityOptions}}" bind:change="onCommunityChange" />
        </van-dropdown-menu>
    </view>

    <!-- 食谱列表 -->
    <view class="menu-list">
        <view class="menu-date">{{currentDate}} 食谱</view>

        <!-- 早餐分类 -->
        <view class="category" wx:if="{{selectedCommunity != 1}}">
            <view class="category-header" bindtap="toggleCategory" data-category="breakfast">
                <text class="category-title">{{menus.breakfast.name}}</text>
                <van-icon name="{{expandedCategories.breakfast ? 'arrow-up' : 'arrow-down'}}" />
            </view>
            <view class="category-content" wx:if="{{expandedCategories.breakfast}}">
                <image src="{{menus.breakfast.image}}" class="menu-image" mode="aspectFill" bindtap="viewImage" data-image="{{menus.breakfast.image}}" data-title="{{menus.breakfast.name}}" />
            </view>
        </view>

        <!-- 午餐分类 -->
        <view class="category">
            <view class="category-header" bindtap="toggleCategory" data-category="lunch">
                <text class="category-title">{{menus.lunch.name}}</text>
                <van-icon name="{{expandedCategories.lunch ? 'arrow-up' : 'arrow-down'}}" />
            </view>
            <view class="category-content" wx:if="{{expandedCategories.lunch}}">
                <image src="{{menus.lunch.image}}" class="menu-image" mode="aspectFill" bindtap="viewImage" data-image="{{menus.lunch.image}}" data-title="{{menus.lunch.name}}" />
            </view>
        </view>

        <!-- 晚餐分类 -->
        <view class="category">
            <view class="category-header" bindtap="toggleCategory" data-category="dinner">
                <text class="category-title">{{menus.dinner.name}}</text>
                <van-icon name="{{expandedCategories.dinner ? 'arrow-up' : 'arrow-down'}}" />
            </view>
            <view class="category-content" wx:if="{{expandedCategories.dinner}}">
                <image src="{{menus.dinner.image}}" class="menu-image" mode="aspectFill" bindtap="viewImage" data-image="{{menus.dinner.image}}" data-title="{{menus.dinner.name}}" />
            </view>
        </view>
    </view>

    <!-- 就餐信息 - 仅在选择通用芳华上地街道养老照料中心时显示 -->
    <view class="info-section" wx:if="{{selectedCommunity == 1}}">
        <view class="info-card">
            <view class="info-header">
                <van-icon name="cash-on-deliver-o" size="32rpx" color="#FF6B35"/>
                <text class="info-title">优惠信息</text>
            </view>
            <view class="info-content">
                <text class="info-text">长者优惠：28元优惠套餐：15元区荤菜1份+9元区半荤菜1份+7元区素菜1份+主食+汤，60周岁及以上老年人注册政府平台信息后，支付满15元以上减1元，支付满20元以上减2元，支付满30元减3元，支付满50元减5元。建议自带餐盒，外带餐盒：套餐餐盒1元/个，汤碗0.5元/个。</text>
            </view>
        </view>

        <view class="info-card">
            <view class="info-header">
                <van-icon name="clock-o" size="32rpx" color="#FF6B35"/>
                <text class="info-title">就餐时间</text>
            </view>
            <view class="info-content">
                <text class="info-text">周一至周五就餐时间:中餐：11：10-12:10，晚餐：17:00-17:30</text>
            </view>
        </view>

        <view class="info-card">
            <view class="info-header">
                <van-icon name="orders-o" size="32rpx" color="#FF6B35"/>
                <text class="info-title">就餐方式</text>
            </view>
            <view class="info-content">
                <text class="info-text">线下：可堂食、可由机构人员送餐到家；线上：饿了么搜索"社区餐厅（上地店）"即可送餐到家，菜谱每周更新</text>
            </view>
        </view>

        <view class="info-card">
            <view class="info-header">
                <van-icon name="location-o" size="32rpx" color="#FF6B35"/>
                <text class="info-title">就餐地点</text>
            </view>
            <view class="info-content">
                <text class="info-text">就餐地址:北京市海淀区农大南路厢黄旗万树园小区东门旁上地街道养老照料中心</text>
            </view>
        </view>
    </view>

    <!-- 图片预览 -->
    <view class="image-viewer" wx:if="{{showImageViewer}}" bindtap="closeImageViewer">
        <image 
            src="{{currentImage}}" 
            class="viewer-image" 
            style="transform: scale({{scale}}) translate({{translateX}}px, {{translateY}}px);" 
            catchtap="preventClose"
            bindtouchstart="onTouchStart"
            bindtouchmove="onTouchMove"
            bindtouchend="onTouchEnd"
        />
        <view class="viewer-title">{{currentImageTitle}}</view>
        <view class="zoom-controls" catchtap="preventClose">
            <button class="zoom-btn zoom-out" catchtap="zoomOut">-</button>
            <text class="zoom-text">{{zoomPercent}}%</text>
            <button class="zoom-btn zoom-in" catchtap="zoomIn">+</button>
        </view>
    </view>
</view>
